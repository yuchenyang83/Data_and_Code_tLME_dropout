% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_realdata_AIDS.R
\name{log.pos.y}
\alias{log.pos.y}
\title{Log joint contribution of responses and dropout indicators for one subject}
\usage{
\method{log}{pos.y}(yi, Ri, wi, Xi, Lam.i, Beta)
}
\arguments{
\item{yi}{numeric vector of length \eqn{n_i}. Subject-specific response vector.}

\item{Ri}{numeric or integer vector of length \eqn{n_i}. Binary response/dropout
indicators per visit (\code{0} or \code{1}); treated as independent
Bernoulli given \code{wi}.}

\item{wi}{numeric vector of length \eqn{n_i}. Per-visit probabilities in \eqn{(0,1)}
used for the Bernoulli part.}

\item{Xi}{numeric matrix of dimension \eqn{n_i \times p}. Design matrix for the
mean model; must be conformable with \code{Beta}.}

\item{Lam.i}{numeric symmetric positive-definite matrix of dimension
\eqn{n_i \times n_i}. Covariance matrix for \eqn{y_i}.}

\item{Beta}{numeric vector of length \eqn{p}. Fixed-effect coefficients.}
}
\value{
A numeric scalar: the log-likelihood contribution
\eqn{\log p(y_i \mid X_i\beta, \Lambda_i) + \log p(R_i \mid w_i)}.
}
\description{
Computes the log-likelihood contribution of a single subject under
(i) a multivariate normal model for the response vector \eqn{y_i}
with mean \eqn{X_i \beta} and covariance \eqn{\Lambda_i}, and
(ii) independent Bernoulli observations for the dropout/response indicators
\eqn{R_i} with success probabilities \eqn{w_i}, i.e.
\deqn{\log p(y_i \mid X_i\beta, \Lambda_i) + \log p(R_i \mid w_i),}
where \eqn{\log p(R_i \mid w_i) = \sum_j \{R_{ij}\log w_{ij} + (1-R_{ij})\log (1-w_{ij})\}.}
}
\details{
The multivariate normal density is evaluated via
\code{mvtnorm::dmvnorm(yi, mean = c(Xi \%*\% Beta), sigma = Lam.i)}.
The indicator contribution is computed as
\code{log(prod(wi^Ri) * prod((1 - wi)^(1 - Ri)))};
for better numerical stability, an equivalent expression is
\code{sum(Ri * log(wi) + (1 - Ri) * log1p(-wi))}.
}
