% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LMMmissingSEM_AIDS.R
\name{I.lmm.missing}
\alias{I.lmm.missing}
\title{Observed-information (Fisher) components for the LME–dropout selection model}
\usage{
I.lmm.missing(
  para.est,
  cor.type = cor.type,
  N,
  cumsum.ni,
  ni,
  mc.size,
  TLam.inv,
  y.conv,
  mechanism,
  dropout.idx,
  R,
  n,
  Data.miss
)
}
\arguments{
\item{para.est}{list. Parameter estimates from the fitted model:
\code{Beta} (fixed effects), \code{D} (random-effects covariance),
\code{sigma}, \code{Phi}, \code{ga} (if applicable), and \code{alpha}.}

\item{cor.type}{character(1). Working correlation structure (e.g., \code{"UNC"},
\code{"CAR1"}, \code{"ARp"}, \code{"BAND1"}, \code{"CS"}, \code{"DEC"}).}

\item{N}{integer(1). Number of subjects.}

\item{cumsum.ni}{integer vector of length \eqn{N}. Cumulative sums of per-subject
visit counts; used to slice block rows/columns.}

\item{ni}{integer vector of length \eqn{N}. Per-subject visit counts \eqn{n_i}.}

\item{mc.size}{integer(1). Monte Carlo sample size (number of completed-data draws)
used for averaging the score/negative-Hessian components.}

\item{TLam.inv}{matrix. Block-diagonal inverse of the longitudinal covariance
across subjects, aligned with the stacked data order.}

\item{y.conv}{matrix. Completed-response draws; typically of size
\code{mc.size} \eqn{\times} \eqn{n} (stacked over all subjects).}

\item{mechanism}{character(1). Dropout mechanism controlling construction of
the dropout-design \eqn{V} (\code{"MNAR"}, \code{"MAR"}, or \code{"MCAR"}).}

\item{dropout.idx}{integer vector. Indices of rows corresponding to dropout events
used in internal diagnostics.}

\item{R}{numeric/integer vector of length \eqn{n}. Dropout/response indicators per row.}

\item{n}{integer(1). Total number of longitudinal rows across all subjects.}

\item{Data.miss}{data.frame. Long-format dataset used to rebuild the dropout
design \eqn{V} (needs columns such as \code{Subject}, \code{Var1}, \code{week}, \code{prevOI}).}
}
\value{
A list with components:
\describe{
\item{out}{Matrix with two rows: the first row (\code{EST}) stacks the parameter
estimates in the order \eqn{(\beta,\ \mathrm{vech}(D),\ \sigma,\ [\Phi,\ \gamma],\ \alpha)};
the second row contains the corresponding standard errors. Column names
are labeled by parameter blocks (e.g., \code{beta}, \code{d}, \code{sigma},
\code{Phi}, \code{ga}, \code{alpha}) with appropriate repetition.}
\item{se}{Numeric vector of standard errors (same order as \code{out} columns).}
\item{I.theta}{Matrix. Estimated observed-information matrix for \eqn{\theta}.}
\item{V.theta}{Matrix. Estimated variance–covariance matrix \eqn{I(\theta)^{-1}}
(or its blockwise inverse variant depending on \code{cor.type}).}
}
}
\description{
Computes observed-information (or related sandwich/outer-product) matrices
for the fitted LME with selection-model dropout, using Monte Carlo averages
over completed-data draws obtained during estimation.
}
\details{
Let \eqn{p} be the number of fixed effects and \eqn{q} the random-effects dimension
(\eqn{q = ncol(D)}). The parameter vector stacks
\eqn{(\beta,\ \mathrm{vech}(D),\ \sigma,\ \Phi,\ \gamma,\ \alpha)}.
The function constructs per-parameter directional derivatives of subject-level
covariance blocks, accumulates Monte Carlo averages of score/Hessian terms,
and forms an observed-information approximation \eqn{I(\theta)} with optional
sandwich corrections. Internally, the function uses \code{vech.posi(q)} for indexing
the lower-triangular part of \eqn{D}; ensure that \eqn{q} is consistent with \code{para.est$D}.
}
