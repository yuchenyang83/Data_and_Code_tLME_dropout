% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_dropout_study.R
\name{MH.y.miss.t.new}
\alias{MH.y.miss.t.new}
\title{Blocked Metropolisâ€“Hastings update over multiple subjects (tLME outcome)}
\usage{
MH.y.miss.t.new(
  y.samp,
  Data.miss,
  y.na.ind,
  Sig.mm.o.MC,
  Xbeta,
  TLam,
  tau,
  R,
  alpha,
  ni,
  cumsum.ni,
  m
)
}
\arguments{
\item{y.samp}{numeric matrix. MCMC sample history of the stacked outcome
vector; the current state is taken from row \code{m - 1}.}

\item{Data.miss}{data.frame. Stacked rows from \code{Data} used to rebuild
the selection design via \code{V.fun()}.}

\item{y.na.ind}{integer vector. Indices of subjects to update (e.g., those
with at least one missing entry).}

\item{Sig.mm.o.MC}{numeric matrix. Proposal covariance for the stacked
missing block (used in \code{mvtnorm::rmvnorm}).}

\item{Xbeta}{numeric vector. Stacked mean \eqn{X \beta} for all entries.}

\item{TLam}{numeric matrix. Block covariance of the stacked outcome.}

\item{tau}{numeric vector. Subject-specific scale parameters; length equals
the number of subjects.}

\item{R}{integer/logical vector. Response indicators on the stacked vector
with convention \code{R == 1} for missing and \code{R == 0} for observed.}

\item{alpha}{numeric vector. Selection-model coefficients used in the joint
target (via \code{yv.joint.log.t()}).}

\item{ni}{integer vector. Per-subject lengths \eqn{(n_1,\ldots,n_S)}.}

\item{cumsum.ni}{integer vector. Cumulative sums of \code{ni} used to locate
subject blocks in the stacked vector.}

\item{m}{integer(1). Current MCMC iteration index; the previous state is
\code{y.samp[m - 1, ]}.}
}
\value{
A numeric vector of the same length as \code{y.samp[1, ]} containing
the updated stacked outcome after the MH sweep.
}
\description{
Performs a single MH sweep over multiple subjects by proposing a global update
on the stacked missing block and then evaluating per-subject accept/reject
decisions under the joint t-based target. The proposal is a Gaussian
random-walk centered at the current missing entries.
}
\details{
A single multivariate normal draw is made for all missing positions in the
stacked vector (mean = current values, covariance = \code{2.4 * Sig.mm.o.MC}),
yielding a candidate \code{y.new}. The selection design is rebuilt at both
states via \code{V.fun()}, and for each subject block \eqn{i} (identified by
\code{cumsum.ni}) a local acceptance ratio is computed using
\code{yv.joint.log.t()} with the corresponding \eqn{X_i\beta}, \eqn{\Lambda_i},
scale \eqn{\tau_i}, design rows, \code{R}, and \code{alpha}. If the proposal
is rejected for block \eqn{i}, the entries of \code{y.new} for that block are
reverted to \code{y.old}.
}
