% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tLMMmissingSEM_simulation.R
\name{I.tlmm.missing}
\alias{I.tlmm.missing}
\title{Observed-information (Fisher) components for the tLME–dropout selection model}
\usage{
I.tlmm.missing(
  para.est,
  cor.type = cor.type,
  X,
  N,
  cumsum.ni,
  ni,
  mc.size,
  TLam.inv,
  y.conv,
  mechanism,
  dropout.idx,
  R,
  n,
  q,
  Data.miss
)
}
\arguments{
\item{para.est}{list. Parameter estimates from the fitted model:
\code{Beta} (fixed effects), \code{D} (random-effects covariance),
\code{sigma}, \code{Phi}, \code{nu}, and \code{alpha}.}

\item{cor.type}{character(1). Working correlation structure (e.g., \code{"UNC"},
\code{"ARp"}, \code{"BAND1"}, \code{"CS"}, \code{"CAR1"}, \code{"DEC"}), as
supported by the helper correlation functions used in the fit.}

\item{X}{matrix. Fixed-effects design matrix aligned with the stacked data.}

\item{N}{integer(1). Number of subjects.}

\item{cumsum.ni}{integer vector of length \eqn{N}. Cumulative sums of per-subject
visit counts; used to slice block rows/columns.}

\item{ni}{integer vector of length \eqn{N}. Per-subject visit counts \eqn{n_i}.}

\item{mc.size}{integer(1). Monte Carlo sample size (number of completed-data draws)
used for averaging the score/negative-Hessian components.}

\item{TLam.inv}{matrix. Block-diagonal inverse of the longitudinal covariance
across subjects, aligned with the stacked data order.}

\item{y.conv}{matrix. Completed-response draws; typically of size
\code{mc.size} \eqn{\times} \eqn{n} (stacked over all subjects).}

\item{mechanism}{character(1). Dropout mechanism controlling construction of
the dropout-design \eqn{V} (\code{"MNAR"}, \code{"MAR"}, or \code{"MCAR"}).}

\item{dropout.idx}{integer vector. Indices of rows corresponding to dropout events
used in internal diagnostics.}

\item{R}{numeric/integer vector of length \eqn{n}. Dropout/response indicators per row.}

\item{n}{integer(1). Total number of longitudinal rows across all subjects.}

\item{q}{integer(1). Random-effects dimension (number of columns in \code{Z}).}

\item{Data.miss}{data.frame. Long-format dataset used to rebuild the dropout
design \eqn{V} (needs columns such as \code{Subject}, \code{Var1}, \code{week}, \code{prevOI}).}
}
\value{
A list with components:
\describe{
\item{out}{Matrix with two rows: the first row (\code{EST}) stacks the parameter
estimates in the order \eqn{(\beta,\ \mathrm{vech}(D),\ \sigma,\ [\Phi],\ \nu,\ \alpha)};
the second row contains the corresponding standard errors. Column names
label parameter blocks (e.g., \code{beta}, \code{d}, \code{sigma}, \code{phi},
\code{nu}, \code{alpha}) with appropriate repetition.}
\item{se}{Numeric vector of standard errors (same order as \code{out} columns).}
\item{I.theta}{Matrix. Estimated observed-information matrix for \eqn{\theta}.}
\item{V.theta}{Matrix. Estimated variance–covariance matrix \eqn{I(\theta)^{-1}}
(or its blockwise inverse variant depending on \code{cor.type}).}
}
}
\description{
Computes observed-information (and related sandwich/outer-product) matrices
for the fitted Student-\eqn{t} LME with selection-model dropout, using Monte
Carlo averages over completed-data draws obtained during estimation.
}
\details{
Let \eqn{p} denote the number of fixed effects and \eqn{q} the random-effects
dimension. The parameter vector stacks
\eqn{(\beta,\ \mathrm{vech}(D),\ \sigma,\ \Phi,\ \nu,\ \alpha)}. The function
forms directional derivatives of subject-level covariance blocks, accumulates
Monte Carlo averages of score/Hessian terms under the t kernel, and builds an
observed-information approximation \eqn{I(\theta)} with sandwich/OPG corrections.
The lower-triangular indexing of \eqn{D} uses \code{vech.posi(q)}; ensure \eqn{q}
matches \code{para.est$D}.
}
