% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_sensitivity_analysis.R
\name{MH.y.miss}
\alias{MH.y.miss}
\title{Single–subject MH update for missing outcomes (selection model)}
\usage{
MH.y.miss(y.c, R, X, Beta, y.na.ind, TLam.i, V, psi, TO, TM)
}
\arguments{
\item{y.c}{numeric vector of length \eqn{n}. Current completed outcome
vector (observed \emph{and} imputed values).}

\item{R}{integer/logical vector of length \eqn{n}. Indicator of missingness
at each observation time within subject; here \code{1} marks entries to be
imputed within a subject block, \code{0} otherwise.}

\item{X}{numeric matrix \eqn{n \times p}. Fixed-effects design aligned with
\code{y.c}.}

\item{Beta}{numeric vector (length \eqn{p}). Fixed-effect coefficients.}

\item{y.na.ind}{integer vector of subject indices that contain at least one
missing response.}

\item{TLam.i}{numeric matrix \eqn{n \times n}. Marginal covariance of
\code{y.c} under the working LME model (block-diagonal by subject).}

\item{V}{numeric matrix used by the dropout (selection) model; rows align
with \code{y.c}.}

\item{psi}{numeric vector of dropout-model coefficients used inside
\code{wi.func()}.}

\item{TO}{list of length \eqn{N}. For subject \eqn{j}, \code{TO[[j]]} is a
selection matrix that picks the observed components within the subject.}

\item{TM}{list of length \eqn{N}. For subject \eqn{j}, \code{TM[[j]]} is a
selection matrix that picks the missing components within the subject.}
}
\value{
The updated numeric vector \code{y.c} (length \eqn{n}) after one MH
sweep. Specifically, values at positions where \code{R == 1} for subjects
listed in \code{y.na.ind} may be replaced by proposed draws.
}
\description{
Performs one Metropolis–Hastings (MH) sweep over subjects with missing
outcomes to impute \eqn{y_{ij}} at the indices where \code{R == 1}, using a
Gaussian proposal built from the conditional mean/variance implied by the
working linear mixed model.
}
\details{
This function relies on a global vector \code{cumsum.nj} to map each subject
\eqn{j} to its row-block \eqn{1{:}n_j} in \code{y.c}. It calls
\code{wi.func()} to compute per-time dropout probabilities and
\code{log.pos.y()} for the joint log-density (outcome + selection part).
}
