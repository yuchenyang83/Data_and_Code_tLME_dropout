% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_sensitivity_analysis.R
\name{OM.fun1}
\alias{OM.fun1}
\title{Build per-visit selection matrices for observed and missing sub-vectors}
\usage{
OM.fun1(Data, n, nj, cumsum.nj, N, R)
}
\arguments{
\item{Data}{data.frame (or tibble). Must contain response column \code{Var1};
\code{is.na(Var1)} determines missingness.}

\item{n}{integer. Number of visit times.}

\item{nj}{integer vector of length \eqn{n}. Number of rows at each visit.}

\item{cumsum.nj}{integer vector of length \eqn{n}. Cumulative sums of
\code{nj}, i.e., \code{cumsum.nj[j] = sum(nj[1:j])}.}

\item{N}{integer. Total number of rows, typically \code{sum(nj)}.}

\item{R}{numeric or integer vector of length \eqn{N}. Per-row missingness
indicator with convention \code{R == 0} for observed and \code{R == 1}
for missing. (Must align with the row order in \code{Data}.)}
}
\value{
A list with two components:
\describe{
\item{TO}{list of length \eqn{n}; \code{TO[[j]]} is a
\eqn{n^{(obs)}_j \times n_j} selection matrix that extracts the observed
entries at visit \eqn{j}.}
\item{TM}{list of length \eqn{n}; \code{TM[[j]]} is a
\eqn{n^{(mis)}_j \times n_j} selection matrix that extracts the missing
entries at visit \eqn{j}.}
}
}
\description{
Produces, for each visit time \eqn{j = 1, \ldots, n}, selection matrices
that extract observed and missing components from a block vector. Compared
to \code{OM.fun}, which returns 0/1 indicator vectors, \code{OM.fun1}
returns row-subsetted diagonal matrices suitable for linear-algebra
operations (e.g., \eqn{S_j y_j}).
}
\details{
For each visit block \code{idx1}, we construct diagonal matrices from the
observed/missing indicators and then keep only the rows corresponding to the
desired subset:
\itemize{
\item \code{TO[[j]] = diag(TTo[idx1])[R[idx1] == 0, ]} selects observed rows,
\item \code{TM[[j]] = diag(TTm[idx1])[R[idx1] == 1, ]} selects missing rows,
}
where \code{TTo = 1 - 1\{is.na(Var1)\}} and \code{TTm = 1\{is.na(Var1)\}}.
The resulting matrices have dimensions \eqn{n^{(obs)}_j \times n_j} and
\eqn{n^{(mis)}_j \times n_j}, respectively, with one nonzero (unity) per row.
}
